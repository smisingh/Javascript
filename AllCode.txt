var startDate = new Date();
var startTime = startDate.getTime();

neocase.form.event.bind("preinit", function() {
    var difference = (new Date()).getTime() - startTime;
    console.warn("Preinit : " + difference);

});

neocase.form.event.bind("init", function() {
    var difference = (new Date()).getTime() - startTime;
    console.warn("Init : " + difference);
    //neocase.form.field('INTERVENTIONS_EN_COURS_MOTCLE').setValue('2297');

});

neocase.form.event.bind("loadcomplete", function() {
    
	var difference = (new Date()).getTime() - startTime;
    console.warn("loadcomplete : " + difference);
	
	nonExistingMandatory();
	nonExistingHide();
	sameFieldAutoPopulate();
    showHideField();
	onSubmitIsAttached();
	
	disableField(neocase.form.field("INTERVENTIONS_EN_COURS$VALEUR800"));

});

neocase.form.event.bind("submit", function() {
	//onSubmitIsAttached();
});


window.sameFieldAutoPopulate = function() {

	var phNo = neocase.form.field('INTERVENTIONS_EN_COURS_VALEUR806').getValue();
    neocase.form.field('INTERVENTIONS_EN_COURS_VALEUR822').setValue(phNo);

    var dateFld = neocase.form.field('INTERVENTIONS_EN_COURS_VALEUR808').getValue();
    neocase.form.field('INTERVENTIONS_EN_COURS_VALEUR824').setValue(dateFld);

    var fileFld = neocase.form.field('INTERVENTIONS_EN_COURS_VALEUR814').getValue();
    neocase.form.field('INTERVENTIONS_EN_COURS_VALEUR830').setValue(fileFld);

    var lstFld = neocase.form.field('INTERVENTIONS_EN_COURS_VALEUR812').getValue();
    neocase.form.field('INTERVENTIONS_EN_COURS_VALEUR828').setValue(lstFld);
    neocase.form.field('INTERVENTIONS_EN_COURS_VALEUR829').setValue(lstFld);
};

window.callHideField = function() {
    neocase.form.section("sectionff456ac3467dc26caed0").hide();
    neocase.form.section("sectionae4e9c4e5de66d484e81").hide();
    neocase.form.section("sectiond86553bf5295d44e0edf").hide();
    neocase.form.section("section0867dba3bccb3449eeac").hide();
    neocase.form.section("section4af96820a934b491f113").hide();

};

window.showHideField = function() {
    callHideField();
    var fldValue = neocase.form.field('INTERVENTIONS_EN_COURS_VALEUR812').getValue();
    if (fldValue == "Section 1") {
        neocase.form.section("sectionff456ac3467dc26caed0").show();
    } else if (fldValue == "Section 2") {
        neocase.form.section("sectionae4e9c4e5de66d484e81").show();
    } else if (fldValue == "Section 3") {
        neocase.form.section("sectiond86553bf5295d44e0edf").show();
    } else if (fldValue == "Section 4") {
        neocase.form.section("section0867dba3bccb3449eeac").show();
    } else if (fldValue == "Section 5") {
        neocase.form.section("section4af96820a934b491f113").show();
    }
};

window.nonExistingMandatory = function() {
	
	neocase.form.field('INTERVENTIONS_EN_COURS$VALEUR1000').mandatory("VALEUR1000 is Required");
};

window.nonExistingHide = function() {
	
	neocase.form.field('INTERVENTIONS_EN_COURS$VALEUR109899').hide();
};

window.onSubmitIsAttached = function() {
	if(neocase.form.attachment.count() > 0){
		if(!neocase.form.attachment.isAttached("^.*\.(jpg|gif|doc|pdf)$")) {
			alert('Accepted file type: jpg, gif, doc, pdf');
			return false;
		}
		else {
			return true;
		}
	} else {
		return false;
	}
};







/***************
* DISABLE FIELDS
****************/
window.disableTextField = function(field){
	if(document.getElementById("champsobligatoiresproprietes")){
	//BackOffice
		field.setAttribute("readonly","true");
		field.onmousedown = function(){return false;};
	}else{
	//FrontOffice
		field.setAttribute("readonly","true");
		field.onkeydown = function(){return false;};
		field.onmousedown = function(){return false;};
	}
};

window.disableBooleanField = function(field){
	field.onclick = function(){return false;};
	disableTextField(field);
};

window.disableDateField = function(field){
	if(document.getElementById("champsobligatoiresproprietes")){
	//BackOffice
		//hide calendar icon
		field.style.background = "none";
	}else{
	//FrontOffice
		//hide calendar icon
		if(field.parentNode.getElementsByTagName("img").length > 0){
			field.parentNode.getElementsByTagName("img")[0].style.display = "none";
		}
	}
	disableTextField(field);
};

window.disableFileField = function(field){
	if(document.getElementById("champsobligatoiresproprietes")){
	//BackOffice
		field.parentNode.parentNode.style.border = "none";
		//hide button browse file
		field.parentNode.style.display = "none";
		//hide button delete file
		if(field.parentNode.parentNode.getElementsByClassName("btn-delete").length > 0){
			field.parentNode.parentNode.getElementsByClassName("btn-delete")[0].style.display = "none";
		}
	}else{
	//FrontOffice
		field.parentNode.getElementsByClassName("fileinput-button")[0].style.display = "none";
	}
};

window.disableListField = function(field){
	if(document.getElementById("champsobligatoiresproprietes")){
	//BackOffice
		field.parentNode.style.border = "none";
	}
	disableTextField(field);
};

window.disableTextareaField = function(field){
	disableTextField(field);
};

window.disableField = function(field){
	var msg = "function disableField : ";
	if(field){
		field = field.elementHTML;
		if(field.type == "checkbox"){
		//Boolean custom fields
			disableBooleanField(field);
		}else if(field.className.search("hasDatepicker") != -1){
		//Date custom fields
			disableDateField(field);
		}else if(field.id.search("_display") != -1){
		//File custom fields
			disableFileField(field);
		}else if(field.tagName == "SELECT"){
		//List custom fields
			disableListField(field);
		}else if(field.tagName == "TEXTAREA"){
		//Textarea custom fields
			disableTextareaField(field);
		}else{
		//Text custom fields
			disableTextField(field);
		}
	}else{
		msg += "field undefined or readonly";
		console.log(msg);
	}
};
